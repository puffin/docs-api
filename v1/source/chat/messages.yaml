  /chat/conversations/{conv_sid}/messages:
    get:
      tags:
        - messages
      summary: Get messages for a conversation
      description: |
        Get a list of messages in a conversation. Use the query parameters to modify the behaviour of this endpoint.

        #### Errors

        This table lists the expected errors that this method could return. However, other
        errors can be returned in the case where the service is down or other unexpected
        factors affect processing. Callers should always check the value of the `ok` params in the response.

        | Error | Description |
        | - | - |
        | conversation_not_found | Value passed for `conv_sid` was invalid. |
        | not_authed | No authentication token provided. |
        | invalid_auth | Invalid authentication token. |
        | invalid_page | Value passed for `page` was invalid |
        | invalid_page_size | Value passed for `page_size` was invalid |

      parameters:
        - name: conv_sid
          in: path
          description: The conversation ID to get the messages for.
          required: true
          type: string
        - $ref: "#/parameters/page"
        - $ref: "#/parameters/page_size"
      responses:
        '200':
          description: Message list retrieval successful
          schema:
            $ref: '#/definitions/Messages'
        '400':
          $ref: '#/responses/BadRequest'
        '401':
          $ref: '#/responses/Unauthorized'
        '403':
          $ref: '#/responses/Forbidden'
        '404':
          $ref: '#/responses/NotFound'

    post:
      tags:
        - messages
      summary: Send message to conversation
      description: |
        Send a message to a conversation.

        #### Errors

        This table lists the expected errors that this method could return. However, other
        errors can be returned in the case where the service is down or other unexpected
        factors affect processing. Callers should always check the value of the `ok` params in the response.

        | Error | Description |
        | - | - |
        | conversation_not_found | Value passed for `conv_sid` was invalid. |
        | not_authed | No authentication token provided. |
        | invalid_auth | Invalid authentication token. |
        | not_in_conversation | Cannot post user messages to a conversation they are not in. |
        | is_archived | Conversation has been archived. |
        | msg_too_long | Message body is too long. |
        | no_text | No message text provided. |

      parameters:
        - name: conv_sid
          in: path
          description: The conversation ID to post the messages to
          required: true
          type: string
        - name: message
          in: body
          description: The message to create.
          schema:
            $ref: '#/definitions/MessageObject'
      responses:
        '201':
          description: Message creation successful
          schema:
            $ref: '#/definitions/Message'
        '400':
          $ref: '#/responses/BadRequest'
        '401':
          $ref: '#/responses/Unauthorized'
        '403':
          $ref: '#/responses/Forbidden'
        '404':
          $ref: '#/responses/NotFound'

  /chat/conversations/{conv_sid}/messages/{sid}:
    put:
      tags:
        - messages
      summary: Update a message
      description: |
        Update a message.

        #### Errors

        This table lists the expected errors that this method could return. However, other
        errors can be returned in the case where the service is down or other unexpected
        factors affect processing. Callers should always check the value of the `ok` params in the response.

        | Error | Description |
        | - | - |
        | conversation_not_found | Value passed for `conv_sid` was invalid. |
        | message_not_found | Value passed for `sid` was invalid. |
        | not_authed | No authentication token provided. |
        | invalid_auth | Invalid authentication token. |
        | cant_update_message | Authenticated user does not have permission to update this message. |
        | msg_too_long | Message body is too long. |
        | no_text | No message text provided. |
      parameters:
        - name: conv_sid
          in: path
          description: The conversation ID to get the messages for.
          required: true
          type: string
        - name: sid
          in: path
          description: A character string that uniquely identifies this message.
          required: true
          type: string
        - name: message
          in: body
          description: The message to create.
          schema:
            $ref: '#/definitions/MessageObject'
      responses:
        '200':
          description: Message update successful
          schema:
            $ref: '#/definitions/Message'
        '400':
          $ref: '#/responses/BadRequest'
        '401':
          $ref: '#/responses/Unauthorized'
        '403':
          $ref: '#/responses/Forbidden'
        '404':
          $ref: '#/responses/NotFound'

    delete:
      tags:
        - messages
      summary: Delete a message
      description: |
        Delete a message.

        #### Errors

        This table lists the expected errors that this method could return. However, other
        errors can be returned in the case where the service is down or other unexpected
        factors affect processing. Callers should always check the value of the `ok` params in the response.

        | Error | Description |
        | - | - |
        | conversation_not_found | Value passed for `conv_sid` was invalid. |
        | message_not_found | Value passed for `sid` was invalid. |
        | not_authed | No authentication token provided. |
        | invalid_auth | Invalid authentication token. |
        | cant_delete_message | Authenticated user does not have permission to delete this message. |
      parameters:
        - name: conv_sid
          in: path
          description: The conversation ID to get the messages for.
          required: true
          type: string
        - name: sid
          in: path
          description: A character string that uniquely identifies this message.
          required: true
          type: string
      responses:
        '200':
          description: Message deletion successful
          schema:
            $ref: '#/definitions/AppOk'
        '400':
          $ref: '#/responses/BadRequest'
        '401':
          $ref: '#/responses/Unauthorized'
        '403':
          $ref: '#/responses/Forbidden'
        '404':
          $ref: '#/responses/NotFound'
